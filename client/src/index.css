@import './print.css';
@tailwind base;
@tailwind components;
@tailwind utilities;

/* iOS PWA Safe Area Handling */
/* iOS PWA Safe Area Handling */
html,
body,
#root {
  height: 100%;
  width: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
  /* Prevent body scroll */
  overscroll-behavior: none;
  /* Prevent rubber banding */
  position: fixed;
  /* Lock viewport */
  inset: 0;
}

/* Hide scrollbar for Chrome, Safari and Opera */
.no-scrollbar::-webkit-scrollbar {
  display: none;
}

/* Hide scrollbar for IE, Edge and Firefox */
.no-scrollbar {
  -ms-overflow-style: none;
  /* IE and Edge */
  scrollbar-width: none;
  /* Firefox */
}

/* PWA Standalone Mode - Handle Safe Areas */
@supports (padding-top: env(safe-area-inset-top)) {
  /* Apply safe area padding only in standalone mode */
  @media all and (display-mode: standalone) {
    html {
      /* Ensure the background color extends behind the status bar */
      background-color: #f9fafb;
    }

    .dark html,
    html.dark {
      background-color: #111827;
    }

    #root {
      /* No safe area padding - content extends edge-to-edge for black-translucent status bar */
    }
  }
}

/* Dark mode CSS for SimpleMDE Editor */
.dark .CodeMirror {
  background-color: #1f2937 !important;
  color: #e5e7eb !important;
  border-color: #374151 !important;
}

.dark .CodeMirror-cursor {
  border-color: #e5e7eb !important;
}

.dark .CodeMirror-gutters {
  background-color: #111827 !important;
  border-color: #374151 !important;
}

.dark .editor-toolbar {
  background-color: #1f2937 !important;
  border-color: #374151 !important;
}

.dark .editor-toolbar a {
  color: #9ca3af !important;
}

.dark .editor-toolbar a:hover,
.dark .editor-toolbar a.active {
  background-color: #374151 !important;
  border-color: #4b5563 !important;
  color: #e5e7eb !important;
}

.dark .CodeMirror-selected {
  background-color: #374151 !important;
}

/* Markdown Preview Styling to match Chat */
.editor-preview,
.editor-preview-side {
  @apply prose prose-sm dark:prose-invert max-w-none p-4 bg-gray-100 dark:bg-gray-800 !important;
  height: 100% !important;
  overflow-y: auto !important;
}

/* Ensure preview text is readable in dark mode */
.dark .editor-preview,
.dark .editor-preview-side {
  color: #e5e7eb !important;
}

.editor-preview img,
.editor-preview-side img {
  max-width: 100%;
  height: auto;
  display: inline-block;
  /* Allow text wrapping if needed, though usually block in prose */
}

/* Fix for CodeMirror scrolling */
/* Fix for CodeMirror scrolling using Absolute Positioning Strategy */
.editor-container {
  position: relative;
  /* Parent must be relative for absolute child */
}

.editor-container .EasyMDEContainer {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  display: flex !important;
  flex-direction: column !important;
  overflow: hidden !important;
  height: 100% !important;
  /* Reinforced */
  width: 100% !important;
}

.editor-container .CodeMirror {
  flex: 1;
  height: auto !important;
  /* Let flex grow it */
  min-height: 0 !important;
  display: flex;
  flex-direction: column;
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}

.editor-container .CodeMirror-scroll {
  flex: 1;
  height: 100% !important;
  min-height: 0;
  overflow-y: auto !important;
  overflow-x: hidden !important;
  margin-bottom: 0 !important;
  padding-bottom: 0 !important;
  position: relative;
}

.editor-container .editor-toolbar {
  flex-shrink: 0;
  border-radius: 0;
  border-top: none;
  border-left: none;
  border-right: none;
}

/* Preview mode */
.editor-container .editor-preview,
.editor-container .editor-preview-side {
  flex: 1;
  height: 100% !important;
  overflow-y: auto !important;
  background-color: #f3f4f6;
  /* bg-gray-100 */
}

.dark .editor-container .editor-preview,
.dark .editor-container .editor-preview-side {
  background-color: #1f2937;
  /* bg-gray-800 */
}

/* Typing Animation */
@keyframes typing {

  0%,
  100% {
    transform: translateY(0);
  }

  50% {
    transform: translateY(-4px);
  }
}

.typing-dot {
  animation: typing 1s infinite ease-in-out;
}

.typing-dot:nth-child(1) {
  animation-delay: 0s;
}

.typing-dot:nth-child(2) {
  animation-delay: 0.2s;
}

.typing-dot:nth-child(3) {
  animation-delay: 0.4s;
}

/* Image Resizing based on Alt Text Suffix */
/* Scoped strictly to content areas to avoid affecting UI/Toolbar */

/* Preview / Viewer Mode */
.toastui-editor-contents img[alt$="|s"],
.toastui-editor-contents img[alt$="%7Cs"],
.toastui-editor-contents img[alt$="_s"] {
  width: 300px !important;
  max-width: 100% !important;
}

.toastui-editor-contents img[alt$="|m"],
.toastui-editor-contents img[alt$="%7Cm"],
.toastui-editor-contents img[alt$="_m"] {
  width: 600px !important;
  max-width: 100% !important;
}

.toastui-editor-contents img[alt$="|l"],
.toastui-editor-contents img[alt$="%7Cl"],
.toastui-editor-contents img[alt$="_l"] {
  width: 100% !important;
}

/* WYSIWYG Editor Mode */
/* Using .ProseMirror ensures we only target the editable content, not the UI */
.ProseMirror img[alt$="|s"],
.ProseMirror img[alt$="%7Cs"],
.ProseMirror img[alt$="_s"] {
  width: 300px !important;
  max-width: 100% !important;
}

.ProseMirror img[alt$="|m"],
.ProseMirror img[alt$="%7Cm"],
.ProseMirror img[alt$="_m"] {
  width: 600px !important;
  max-width: 100% !important;
}

.ProseMirror img[alt$="|l"],
.ProseMirror img[alt$="%7Cl"],
.ProseMirror img[alt$="_l"] {
  width: 100% !important;
}

/* Toast UI Editor Dark Mode Overrides */
.dark .toastui-editor-defaultUI {
  border-color: #374151;
  background-color: #111827;
}

:root {
  --toolbar-height: 46px;
}

/* Light Mode Toolbar Height */
.toastui-editor-defaultUI .toastui-editor-toolbar {
  height: var(--toolbar-height);
  min-height: var(--toolbar-height);
  box-sizing: border-box;
}

/* Dark Mode Toolbar */
/* Dark Mode Toolbar */
.dark .toastui-editor-defaultUI-toolbar,
.dark .toastui-editor-defaultUI .toastui-editor-toolbar {
  --toastui-editor-toolbar-bg: #1f2937;
  /* fallback if variable not used by specific version */
  background-color: var(--toastui-editor-toolbar-bg, #1f2937) !important;
  border-bottom: 1px solid #374151;
  height: var(--toolbar-height);
  min-height: var(--toolbar-height);
  box-sizing: border-box;
}

.dark .toastui-editor-defaultUI .toastui-editor-toolbar button {
  border-color: transparent;
  color: #e5e7eb;
}

.dark .toastui-editor-defaultUI .toastui-editor-toolbar button:hover {
  background-color: #374151;
  border-color: #374151;
}

.dark .toastui-editor-md-container,
.dark .toastui-editor-ww-container {
  background-color: #111827;
  color: #e5e7eb;
}

.dark .toastui-editor-defaultUI .toastui-editor-mode-switch {
  background-color: #1f2937;
  border-top: 1px solid #374151;
}

.dark .toastui-editor-defaultUI .toastui-editor-mode-switch .tab-item {
  color: #9ca3af;
}

.dark .toastui-editor-defaultUI .toastui-editor-mode-switch .tab-item.active {
  background-color: #374151;
  color: #e5e7eb;
}

/* Adjust Prosemirror content in dark mode */
.dark .ProseMirror {
  color: #e5e7eb;
}

.dark .toastui-editor-contents {
  font-family: inherit;
}

.dark .toastui-editor-contents p,
.dark .toastui-editor-contents h1,
.dark .toastui-editor-contents h2,
.dark .toastui-editor-contents h3,
.dark .toastui-editor-contents h4,
.dark .toastui-editor-contents h5,
.dark .toastui-editor-contents h6,
.dark .toastui-editor-contents li {
  color: #e5e7eb;
}